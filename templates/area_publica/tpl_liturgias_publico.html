{% extends 'base.html' %}
{% load static %}

{% block title %}Liturgia Diária{% endblock %}

{% block extra_css %}
<style>
    /* === ESTILOS GERAIS === */
    .hero-section {
        padding: 0;  /* Remove padding padrão da seção hero */
    }
    
    
    
    .liturgia-data-cell {
        color: #6c757d;
        font-size: 0.9em;
        white-space: nowrap;
    }
    
    .liturgia-tipo-cell {
        font-weight: 600;
        color: #212529;
    }
    
    .liturgia-texto-cell {
        color: #495057;
    }
    
    
    
    
    /* === RESPONSIVO === */
    @media (max-width: 768px) {
</style>
{% endblock %}

{% block content %}

<!-- Hero Section -->
<div class="hero-section">
    <div class="container">
        <div class="hero-content">
            <h1 class="mb-3 text-center">
                <i class="fas fa-bible me-3"></i>
                Liturgia Diária
            </h1>
            <p class="lead mb-0 text-center">
                Fonte de vida e sabedoria
            </p>
        </div>
    </div>
</div>

<!-- Container Principal -->
<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            
            <!-- Container de Busca por Data e Tipo -->
            <div class="container-busca">
                <h5 class="mb-4">
                    <i class="fas fa-search me-2"></i>
                    Filtrar Liturgias
                </h5>
                
                <form method="get" class="row g-3" onsubmit="return lockFormButtons(this)">
                    <div class="col-md-4">
                        <label for="data" class="form-label fw-bold">Data</label>
                        <input type="date" 
                               name="data" 
                               id="data"
                               class="form-control" 
                               value="{{ data_filtro }}">
                    </div>
                    
                    <div class="col-md-6">
                        <label for="tipo" class="form-label fw-bold">Tipo de Liturgia</label>
                        <select name="tipo" 
                                id="tipo"
                                class="form-select">
                            <option value="">Todos os tipos</option>
                            {% for valor, nome in tipos_disponiveis %}
                                <option value="{{ valor }}" {% if tipo_filtro == valor %}selected{% endif %}>
                                    {{ nome }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="col-md-2 d-flex align-items-end">
                        <button type="submit" class="btn btn-buscar w-100 btn-gravar-global">
                            <i class="fas fa-search me-2"></i>
                            Buscar
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Container de Lista de Liturgias -->
            <div class="container-lista">
                <h5 class="mb-4">
                    <i class="fas fa-list me-2"></i>
                    {% if data_filtro or tipo_filtro %}
                        Liturgias Encontradas
                    {% else %}
                        Liturgias Recentes
                    {% endif %}
                </h5>
                
                {% if liturgias_por_data %}
                    {% for data_str, liturgias_data in liturgias_por_data.items %}
                        <div class="grupo-data">
                            <div class="grupo-data-header">
                                <i class="fas fa-calendar me-2"></i>
                                {{ data_str }}
                            </div>
                            
                            <!-- Cards para Mobile -->
                            <div class="liturgia-cards-container">
                                {% for liturgia in liturgias_data %}
                                <div class="liturgia-card">
                                    <div class="liturgia-card-header">
                                        {{ liturgia.LIT_TIPOLIT }}
                                    </div>
                                    <div class="liturgia-card-body">
                                        {{ liturgia.LIT_TEXTO|linebreaks }}
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                            
                            <!-- Tabela para Desktop -->
                            <table class="liturgia-table">
                                <thead>
                                    <tr>
                                        <th style="width: 180px;">Tipo</th>
                                        <th>Texto</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for liturgia in liturgias_data %}
                                    <tr>
                                        <td class="liturgia-tipo-cell">
                                            {% if liturgia.LIT_TIPOLIT == 'Primeira Leitura' %}
                                                <span class="badge-tipo badge-primeira-leitura">
                                                    {{ liturgia.LIT_TIPOLIT }}
                                                </span>
                                            {% elif liturgia.LIT_TIPOLIT == 'Segunda Leitura' %}
                                                <span class="badge-tipo badge-segunda-leitura">
                                                    {{ liturgia.LIT_TIPOLIT }}
                                                </span>
                                            {% elif liturgia.LIT_TIPOLIT == 'Salmo Responsorial' %}
                                                <span class="badge-tipo badge-salmo">
                                                    {{ liturgia.LIT_TIPOLIT }}
                                                </span>
                                            {% elif liturgia.LIT_TIPOLIT == 'Evangelho' %}
                                                <span class="badge-tipo badge-evangelho">
                                                    {{ liturgia.LIT_TIPOLIT }}
                                                </span>
                                            {% else %}
                                                <span class="badge-tipo badge-outros">
                                                    {{ liturgia.LIT_TIPOLIT }}
                                                </span>
                                            {% endif %}
                                        </td>
                                        <td class="liturgia-texto-cell">
                                            {{ liturgia.LIT_TEXTO|linebreaks }}
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="text-center p-4">
                        <i class="fas fa-book fa-3x text-muted mb-3"></i>
                        <p class="text-muted">Nenhuma liturgia encontrada para os filtros selecionados.</p>
                    </div>
                {% endif %}
            </div>
            
        </div>
    </div>
</div>

<!-- Botão Flutuante HOME -->
<a href="{{ url_retorno|default:'/' }}" class="fly-float-btn fly-float-btn-left d-flex align-items-center justify-content-center text-decoration-none" title="Voltar">
    <i class="fas fa-home"></i>
</a>

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Definir data de hoje como padrão se não houver filtro
    const dataInput = document.getElementById('data');
    if (dataInput && !dataInput.value) {
        const hoje = new Date().toISOString().split('T')[0];
        dataInput.value = hoje;
    }
});
</script>
{% endblock %}

